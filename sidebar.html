<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chota@latest/dist/chota.min.css">
    
    <?!= HtmlService.createHtmlOutputFromFile('sidebar_css').getContent(); ?>
</head>
<body>
    <div class="flex-container">
        <h4>✨ AI Assistant</h4>
        <p style="margin-top: -0.5rem; color: #6c757d;">Enter a prompt to analyze the data in the selected region.</p>
        
        <div class="form-group">
            <label for="cell">
              Analyze Region:
            </label>
            <div>
              <input type="text" id="cell" value="A1:B10">
              <button id="refresh_range_button" class="button tiny" style="padding: 2px 6px; vertical-align: middle;">⟳</button>
            </div>
        </div>

        <div class="form-group">
            <label for="question">User Prompt:</label>
            <textarea id="question" rows="4" placeholder="Additional comment!"></textarea>
        </div>

        <div id="ask_container">
            <button id="sidebar_ask_button" class="button primary">Ask</button>
            <div id="loader" class="loading hidden"></div>
        </div>
        
        <div id="ai_response_block" class="hidden">
            <h5>AI Suggestion</h5>
            <p id="ai_response"></p>
            <footer>
                <button id="sidebar_ai_response_confirm_button" class="button success">Confirm</button>
                <button id="sidebar_ai_response_cancel_button" class="button">Cancel</button>
            </footer>
        </div>
        
        <div id="status" class="text-error"></div>
    </div>
    
    <?!= HtmlService.createHtmlOutputFromFile('sidebar_js').getContent(); ?>
</body>
</html>
